name: CI/CD Pipeline
on:
  push:
    branches:
      - main
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v1
      - name: Log in to DockerHub
        run: echo $DOCKERHUB_PASSWORD | docker login -u $DOCKERHUB_USERNAME --password-stdin
      - name: Build and push Docker image
        run: |
          docker build . -t $DOCKERHUB_USERNAME/aks-store-demo:latest
          docker push $DOCKERHUB_USERNAME/aks-store-demo:latest



#name: CI/CD Pipeline

#on:
#  push:
#    branches:
#      - main
  
#  pull_request:
#    branches:
#      - main

#jobs:
#  build:
#    runs-on: ubuntu-latest

#    steps:
    
#    - name: Checkout code
#      uses: actions/checkout@v2

      
#    - name: Set up Python
#      uses: actions/setup-python@v2
#      with:
#        python-version: '3.12'

      
#    - name: Install dependencies
#      run: |
#        python -m pip install --upgrade pip
#        pip install -r src/ai-service/requirements.txt

      
#    - name: Build Docker image
#      run: |
#        docker build -t grupo5sd/projeto:${{ github.sha }} .
#        echo $DOCKERHUB_PASSWORD | docker login -u $DOCKERHUB_USERNAME --password-stdin
#        docker push grupo5sd/projeto:${{ github.sha }}

      
#    - name: Deploy to k3s
#      run: |
#        kubectl apply -f k3s/deployment.yaml